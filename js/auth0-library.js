!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).auth0={})}(this,function(e){"use strict";const t="1234567890",n="ABCDEFGHIJKLMNOPQRSTUVWXYZ",r="abcdefghijklmnopqrstuvwxyz",o=n+r+t;function i(e,t){return Array.from(crypto.getRandomValues(new Uint8Array(e))).map(e=>t[e%t.length]).join("")}const a=e=>i(e,o),s=e=>i(e,n+r);function c(e){const t=s(16);return async function(e,t){const n=new TextEncoder,r=await crypto.subtle.digest({name:"SHA-256"},n.encode(e));return function(e){const t=new Uint8Array(e);return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}(r)}(t)}const u=(e,t)=>e.dispatchEvent(new CustomEvent(t,{bubbles:!0,cancelable!0})),l=(e,t,n)=>e.addEventListener(t,n),d=(e,t,n)=>e.removeEventListener(t,n);var p={"auth0-spa-js":e.version};const f=e=>"i"===e[0]&&"p"===e[1]&&"i"===e[2];async function m(e,t){let n=!1;try{const r=await fetch(`https://ipinfo.io/json?token=${t}`);if(r.ok){const t=await r.json(),o=["AT","BE","BG","HR","CY","CZ","DK","EE","FI","FR","DE","GR","HU","IS","IE","IT","LV","LI","LT","LU","MT","NL","NO","PL","PT","RO","SK","SI","ES","SE","GB"].some(e=>e===t.country);n=o||"EU"===t.continent}}catch(e){}return e&&!n?e:n}const g=()=>{const e=window.navigator.userAgent,t=e.match(/(cordova)/i),n=e.match(/(swift)/i);return t&&t.length>0||n&&n.length>0};class h{constructor(e,t){this.spec=e,this.telemetry=t}get(e){const t=window.localStorage.getItem(e);if(t)try{const e=JSON.parse(t);return new Date>new Date(e.expiresAt)?(window.localStorage.removeItem(e),null):e.data}catch(e){}return null}set(e,t,n){const r=new Date;r.setSeconds(r.getSeconds()+n),window.localStorage.setItem(e,JSON.stringify({data:t,expiresAt:r.toUTCString()}))}remove(e){window.localStorage.removeItem(e)}}class w{constructor(){this.cache={}}get(e){return this.cache[e]}set(e,t){this.cache[e]=t}remove(e){delete this.cache[e]}}const b=e=>{const t=e.find(e=>"none"===e.prompt);return t?Promise.resolve(t):Promise.reject("Could not find an iframe with prompt=none")};e.version="2.1.3",e.createAuth0Client=async e=>{const t=e.redirect_uri||e.redirectUri,n=e.client_id||e.clientId,r="default"===(e.cache||e.cacheLocation)?"localstorage":e.cache||e.cacheLocation||"memory",o="localstorage"===r?new h:new w;let i;const s=async()=>{let t=!1;return(i=await(async e=>{const t=e.scope?e.scope.split(" "):[],n=t.reduce((e,t)=>(e[t]=!0,e),{});return n.openid||(e.scope=(t.concat("openid")).join(" ")),n.profile||(e.scope=(e.scope.split(" ").concat("profile")).join(" ")),n.email||(e.scope=(e.scope.split(" ").concat("email")).join(" ")),await(async e=>{const t=e.advancedOptions&&"string"==typeof e.advancedOptions.defaultScope?e.advancedOptions.defaultScope:"openid profile email";e.scope=e.scope||t;const n=new Set(e.scope.split(" ").filter(Boolean));return e.useRefreshTokens&&n.add("offline_access"),[...n].join(" ")})(e)})(e)).includes("offline_access")&&(t=await m(t,e.leeway)),t},y=g(),v=navigator.credentials,x=e.useRefreshTokensFallback,I=e.useRefreshTokens;var S;S=Object.assign({},e,{client_id:n,redirect_uri:t}),e=Object.assign({},p,e.telemetry),Object.assign(S,{telemetry:btoa(JSON.stringify(e))});let k,C={};const L=async(e,t)=>{const n=await c(e),r=await async function(e,t){try{const n=(await t()).message;return new URLSearchParams({code_challenge:n,code_challenge_method:"S256"})}catch(e){return new URLSearchParams}}({},(async()=>(await b(C[e]||[])).controller.signal));return r.set("verifier",e),r};return async function(e,t){const n=await c(),r={method:"S2K",key:n};let i={};try{i=await(await fetch(e,t)).json()}catch(e){throw new Error("Could not get an access token")}const a=await async function(e,t){const n=e.split("."),r=JSON.parse(atob(n[1]));return!(!r.exp||Date.now()>=1e3*r.exp-t)}(i.access_token,0);return a?i.access_token:Promise.reject("Could not get a new access token")}(location.origin+`/api/token?state=${a(16)}`,{headers:{Authorization:`Bearer ${r.key}`}}).then(e=>{k=e})}},Object.defineProperty(e,"__esModule",{value:!0});
